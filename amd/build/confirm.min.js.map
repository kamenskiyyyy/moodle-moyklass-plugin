{"version":3,"file":"confirm.min.js","sources":["../src/confirm.js"],"sourcesContent":["// This file is part of Moodle Course Rollover Plugin\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n\n/**\n * @package\n * @author      Nikolay\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['jquery', 'core/modal_factory', 'core/str', \"core/modal_events\", 'core/ajax', 'core/notification'],\n    function($, ModalFactory,\n             String, ModalEvents,\n             Ajax, Notification) {\n        const trigger = $('.local_moyclass_delete_button');\n        ModalFactory.create({\n            type: ModalFactory.types.SAVE_CANCEL,\n            title: String.get_string('moyclass_delete_record_title', 'local_moyclass'),\n            body: String.get_string('moyclass_delete_record_desc', 'local_moyclass'),\n            preShowCallback: function(triggerElement, modal) {\n                triggerElement = $(triggerElement);\n                let classString = triggerElement[0].classList[0];\n                let recordid = classString.substr(classString.lastIndexOf('local_recordid') + 'local_recordid'.length);\n\n                modal.params = {'recordid': recordid};\n                modal.setSaveButtonText(String.get_string('moyclass_delete_record_title', 'local_moyclass'));\n            },\n            large: true,\n        }, trigger)\n            .done(function(modal) {\n                // Do what you want with your new modal.\n                modal.getRoot().on(ModalEvents.save, function(e) {\n                    e.preventDefault();\n\n                    let footer = Y.one('.modal-footer');\n                    footer.setContent(String.get_string('moyclass_delete_record_loading', \"local_moyclass\"));\n                    let spinner = M.util.add_spinner(Y, footer);\n                    spinner.show();\n\n                    let request = {\n                        methodname: \"local_moyclass_delete_record\",\n                        args: modal.params,\n                    };\n\n                    Ajax.call([request])[0]\n                        .done(function(data) {\n                            if (data === true) {\n                                window.location.reload();\n                            } else {\n                                Notification.addNotification({\n                                    message: String.get_string(\"moyclass_delete_record_fail\", \"local_moyclass\"),\n                                    type: \"error\",\n                                });\n                            }\n                        }).fail(Notification.exception);\n                });\n            });\n    });\n"],"names":["define","$","ModalFactory","String","ModalEvents","Ajax","Notification","trigger","create","type","types","SAVE_CANCEL","title","get_string","body","preShowCallback","triggerElement","modal","classString","classList","recordid","substr","lastIndexOf","length","params","setSaveButtonText","large","done","getRoot","on","save","e","preventDefault","footer","Y","one","setContent","M","util","add_spinner","show","request","methodname","args","call","data","window","location","reload","addNotification","message","fail","exception"],"mappings":";;;;;AAsBAA,gCAAO,CAAC,SAAU,qBAAsB,WAAY,oBAAqB,YAAa,sBAClF,SAASC,EAAGC,aACHC,OAAQC,YACRC,KAAMC,oBACLC,QAAUN,EAAE,iCAClBC,aAAaM,OAAO,CAChBC,KAAMP,aAAaQ,MAAMC,YACzBC,MAAOT,OAAOU,WAAW,+BAAgC,kBACzDC,KAAMX,OAAOU,WAAW,8BAA+B,kBACvDE,gBAAiB,SAASC,eAAgBC,WAElCC,aADJF,eAAiBf,EAAEe,iBACc,GAAGG,UAAU,GAC1CC,SAAWF,YAAYG,OAAOH,YAAYI,YAAY,kBAAoB,iBAAiBC,QAE/FN,MAAMO,OAAS,UAAaJ,UAC5BH,MAAMQ,kBAAkBtB,OAAOU,WAAW,+BAAgC,oBAE9Ea,OAAO,GACRnB,SACEoB,MAAK,SAASV,OAEXA,MAAMW,UAAUC,GAAGzB,YAAY0B,MAAM,SAASC,GAC1CA,EAAEC,qBAEEC,OAASC,EAAEC,IAAI,iBACnBF,OAAOG,WAAWjC,OAAOU,WAAW,iCAAkC,mBACxDwB,EAAEC,KAAKC,YAAYL,EAAGD,QAC5BO,WAEJC,QAAU,CACVC,WAAY,+BACZC,KAAM1B,MAAMO,QAGhBnB,KAAKuC,KAAK,CAACH,UAAU,GAChBd,MAAK,SAASkB,OACE,IAATA,KACAC,OAAOC,SAASC,SAEhB1C,aAAa2C,gBAAgB,CACzBC,QAAS/C,OAAOU,WAAW,8BAA+B,kBAC1DJ,KAAM,aAGf0C,KAAK7C,aAAa8C"}